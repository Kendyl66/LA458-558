<!DOCTYPE html>
<html>
    <head>
    <meta charset="utf-8"/>
    <meta name="exercises" content="universities"/>
<title> Exercise 13</title>
        
        <script src="https://code.jquery.com/jquery-3.1.1.min.js"></script>
        
        <link rel="stylesheet" href="https://unpkg.com/leaflet@1.4.0/dist/leaflet.css"
        integrity="sha512-puBpdR0798OZvTTbP4A8Ix/l+A4dHDD0DGqYW6RQ+9jxkRFclaxxQb/SJAWZfWAkuyeQUytO7+7N4QKrDh+drA=="crossorigin=""/> 
        
        <script src="https://unpkg.com/leaflet@1.4.0/dist/leaflet.js"
        integrity="sha512-QVftwZFqvtRNi0ZyCtsznlKSWOStnDORoefr1enyq5mVL4tmKB3S/EnC3rRJcxCPavG10IcrVGSmPh6Qw5lwrg==" crossorigin=""></script> 
        
        <script src="https://code.jquery.com/jquery-3.1.0.js"></script>	
        <script src="https://code.jquery.com/jquery-2.2.4.js"></script>
               
        <!--ajax plugin import and geojson file -->     
     <script src="https://indicator.extension.iastate.edu/classes/leaflet-ajax-gh-pages/dist/leaflet.ajax.min.js"></script>

        
    <style>
        #map {
            width:700px;
            height: 600px;
            margin: 0 auto; padding: 10px;
            border: solid;
            border-color: black; 
            border-width: 10px;
            }
        div {
            display: block; 
            margin-left: 0 auto;
            margin-right: 0 auto;
            
        }
        body   { 
        color: black;
        font-family: verdana;
            margin: 0 auto;
        }
    body:after {
        background: url(IMG_9275.HEIC);
        content: "";
        opacity: 0.15;
        position:fixed;
        top: 0;
        bottom: 0;
        right: 0;
        left: 0;
        z-index: -100;   
        width:auto;
        height: 100%;
        background-size: cover;
        }
     h1 {
        font-family: sans-serif;
        color: black;
        text-align: center;
        font-size: 45px;    
    }
    
     h2 {
        font-family: sans-serif;
        color: black;
        text-align: center;
        font-size: 25px;     
    }
    
    p {text-align: center;
        font-family: sans-serif;
        color: black;
        font-size: 20px;
        margin: 0px 50px 0px 50px;
    }
    a:link{ color: black; font-size: 100%}
        a:visited{ color: salmon}
        a:hover{ color: palevioletred}
    
        
    #slide { align-content: center;
        display: block;
        margin: 0 auto;
        width: 1000px;
        height: 700px;
        border: solid;
            border-color:black;
            border-width: thick;
    }
    #slide1 { align-content: center;
        display: block;
        margin: 0 auto;
        width: 1000px;
        height: 700px;
        border: solid;
            border-color:black;
            border-width: thick;
    }
    .mySlides {
            border: solid;
            border-color:black;
            border-width: thick;
        }
    </style>
    </head>
    <body>
        <h1 style=" font-size: 300%;"> Exercise 13: AJAX Plugin and GeoJson
        </h1>
    
        <div id="map"></div>
        
 <script> 
     var map;
     //GeoJson map with local data

     var moscow = {
  "type": "FeatureCollection",
  "features": [
    {
      "type": "Feature",
      "properties": {
        "stroke": "#4d4d4d",
        "stroke-width": 2,
        "stroke-opacity": 1,
        "fill": "#1affba",
        "fill-opacity": 0.3,
        "Name": "Moscow Downtown Historic District",
        "Historic": 1
      },
      "geometry": {
        "type": "Polygon",
        "coordinates": [
          [
            [
              -117.00274229049683,
              46.72808044984148
            ],
            [
              -116.99997425079346,
              46.7279774908726
            ],
            [
              -117.00006008148192,
              46.73074260636998
            ],
            [
              -117.00006008148192,
              46.73359582162204
            ],
            [
              -117.00274229049683,
              46.733669356102304
            ],
            [
              -117.00274229049683,
              46.72808044984148
            ]
          ]
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "stroke": "#555555",
        "stroke-width": 2,
        "stroke-opacity": 1,
        "fill": "#ef8fa8",
        "fill-opacity": 0.3,
        "Name": "Fort Russell Historic District ",
        "Historic": 1
      },
      "geometry": {
        "type": "Polygon",
        "coordinates": [
          [
            [
              -116.98855876922607,
              46.73250749959103
            ],
            [
              -116.98851585388184,
              46.73365464921425
            ],
            [
              -116.9899320602417,
              46.733684062986285
            ],
            [
              -116.9899320602417,
              46.734654708464
            ],
            [
              -116.98988914489746,
              46.73512531816445
            ],
            [
              -116.98851585388184,
              46.7350959051785
            ],
            [
              -116.98855876922607,
              46.73641947366447
            ],
            [
              -116.98924541473389,
              46.73641947366447
            ],
            [
              -116.98928833007812,
              46.73597828777874
            ],
            [
              -116.9899320602417,
              46.73603711277206
            ],
            [
              -116.98988914489746,
              46.73674300768658
            ],
            [
              -116.99246406555176,
              46.73653712262439
            ],
            [
              -116.99229240417479,
              46.73794889012222
            ],
            [
              -116.99289321899413,
              46.73786065573646
            ],
            [
              -116.9929790496826,
              46.73739006990738
            ],
            [
              -116.9935369491577,
              46.737360658156696
            ],
            [
              -116.99349403381346,
              46.7369194799714
            ],
            [
              -116.99388027191162,
              46.7369194799714
            ],
            [
              -116.99392318725586,
              46.73741948164202
            ],
            [
              -116.99521064758301,
              46.737360658156696
            ],
            [
              -116.99568271636964,
              46.736713595582984
            ],
            [
              -116.99568271636964,
              46.736125350141705
            ],
            [
              -116.99606895446777,
              46.736007700283416
            ],
            [
              -116.99619770050047,
              46.73627241210362
            ],
            [
              -116.99662685394287,
              46.73621358736698
            ],
            [
              -116.99662685394287,
              46.73594887525802
            ],
            [
              -116.99714183807373,
              46.73594887525802
            ],
            [
              -116.99718475341797,
              46.73530179574332
            ],
            [
              -116.99830055236818,
              46.73515473113437
            ],
            [
              -116.99838638305664,
              46.73547827274465
            ],
            [
              -116.99872970581053,
              46.73539003431616
            ],
            [
              -116.99877262115477,
              46.73427233505832
            ],
            [
              -116.99928760528564,
              46.73433116191259
            ],
            [
              -116.99928760528564,
              46.73400761342003
            ],
            [
              -116.99967384338379,
              46.73403702699955
            ],
            [
              -116.99967384338379,
              46.73371347674232
            ],
            [
              -116.99967384338379,
              46.7330663704043
            ],
            [
              -116.99821472167967,
              46.73312519857407
            ],
            [
              -116.99821472167967,
              46.73238984183975
            ],
            [
              -116.98855876922607,
              46.73250749959103
            ]
          ]
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "Name": "University of Idaho Administration Building",
        "Historic": 2
      },
      "geometry": {
        "type": "Polygon",
        "coordinates": [
          [
            [
              -117.01153993606567,
              46.72524165199677
            ],
            [
              -117.01054215431212,
              46.72524165199677
            ],
            [
              -117.01054215431212,
              46.72607271450009
            ],
            [
              -117.01153993606567,
              46.72607271450009
            ],
            [
              -117.01153993606567,
              46.72524165199677
            ]
          ]
        ]
      }
    }
  ]
};

//Base Layers Added
        var OSM = L.tileLayer('http://{s}.tile.osm.org/{z}/{x}/{y}.png', {
    attribution: '&copy; <a href="http://osm.org/copyright">OpenStreetMap</a> contributors'
});
        var Esri_WorldImagery = L.tileLayer('https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}', {
	attribution: 'Tiles &copy; Esri &mdash; Source: Esri, i-cubed, USDA, USGS, AEX, GeoEye, Getmapping, Aerogrid, IGN, IGP, UPR-EGP, and the GIS User Community'
});  
     //overlay layers
     var Stamen_TonerLines = L.tileLayer('https://stamen-tiles-{s}.a.ssl.fastly.net/toner-lines/{z}/{x}/{y}{r}.{ext}', {
	attribution: 'Map tiles by <a href="http://stamen.com">Stamen Design</a>, <a href="http://creativecommons.org/licenses/by/3.0">CC BY 3.0</a> &mdash; Map data &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',
	subdomains: 'abcd',
	minZoom: 0,
	maxZoom: 20,
	ext: 'png'
});
     
    
        //Create Map
        
    var map = L.map('map', {
        center: new L.LatLng(46.73, -117),
        zoom: 15,
        layers: [OSM, Esri_WorldImagery]
    });
        

        
    function getColor(Historic) {
        return Historic == 1 ? 'red':
                Historic == 2 ? 'blue':
                    'white';
        
    }
        
    function style (feature) {
        return {
            weight: 2,
            opacity: 0.75,
            color: getColor(feature.properties.Historic)
        };
    }
var district = L.geoJson(moscow, {style: style}).addTo(map);
        //Layer Control
    var baseMaps = {
        "Street Map": OSM,
        "Satellite Images": Esri_WorldImagery,
    };
    
    var overlayMaps = {
        "Outline": Stamen_TonerLines,
          
    };
    
        L.control.layers(baseMaps,overlayMaps).addTo(map);

        </script>
        
        <script>
                var myURL = "https://kendyl66.github.io/LA458-558/ex13/eating.geojson";
     function style (feature) {
         return {
             stroke: false,
             fillColor: getColor(feature.properties.ranking),
             weight: 1,
             opacity: 0.5,
        
             var geojsonLayer = new L.GeoJSON.AJAX(myURL, {
        style: style,
        pointToLayer: function (feature, latlng) {
            return new L.circleMarker (latlng, 
                { stroke: true,
                fillOpacity:0.75,
                 radius : feature.properties.ranking + 10,
                });
        }, 
        onEachFeature: function (feature, layer) {
            htmlText = "Name:" + "<strong>" + feature.properties.Name + "</strong> <br> Top Sites Ranking:<b>" + feature.properties.ranking; 
        layer.bindPopup (htmlText);
                layer.bindTooltip(feature.properties.Name);
        }
    }).addTo(map);
    
    var breaks = [1,2,3];
    var labels = ['My Favorite', 'Really Good', 'Still Good'];
    function getColor(d) {
         return d == 3 ? '#d53e4f': //redish
                d == 2 ? '#abdda4': //greenish
                d == 1 ? '#3288bd': // blue
                '#ff0000'; //white       
    }
            var legend = L.control({ 
    position: 'bottomleft'});
     
legend.onAdd = function (map) {
        var div = L.DomUtil.create('div', 'info legend'); 
           
        div.innerHTML += "<b> Top Sites Ranking</b> <br>"
         
    for (var i = 0; i <breaks.length; i++){ 
    div.innerHTML +=
        '<i style="background:' + getColor(breaks[i]) + ' "></i> ' + labels[i] + (breaks ? '' + '<br>' : '');
        }
    return div;
     };
     legend.addTo(map);
            
        </script>
    </body>
</html>